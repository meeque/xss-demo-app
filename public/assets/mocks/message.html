<!DOCTYPE html>
<html>
<head>
<title>XSS Demo: Post-Message Events Mock</title>
<link rel="stylesheet" href="../common.css">
<link rel="stylesheet" href="message.css">
<script src="../common.js"></script>
<script src="message.js"></script>
</head>
<body>

  <header>
    <h1>XSS Demo: Post-Message Events Mock</h1>
    <p>
      This is a simple HTML document that displays post-message events that it receives.
    </p>
  </header>

  <main>
    <article class="origins">
      <h2>Trusted Origins</h2>

      <p>Post-message events from the following origins will be considered trusted:</p>

      <table class="origins">
        <tr class="head">
          <th>Origin</th>
          <th>Actions</th>
        </tr>
        <tr class="message info empty">
          <td colspan="9">No origins are currently considered trusted.</td>
        </tr>
        <tr class="actions">
          <td class="message warning"></td>
          <td><button type="button" name="new">New trusted origin...</button></td>
        </tr>
      </table>

      <template id="origin">
        <tr class="origin">
          <td class="origin">
            <input type="text" name="origin">
          </td>
          <td class="actions">
            <button type="button" name="untrust">Untrust</button>
            <button type="button" name="trust">Trust</button>
            <button type="button" name="cancel">Cancel</button>
          </td>
        </tr>
      </template>
    </article>

    <article class="events">

      <h2>Received Post-Message Events</h2>

      <p>The following post-message events have been received so far:</p>

      <table class="events">
        <tr class="head">
          <th>Trust</th>
          <th>Sender Origin</th>
          <th>Timestamp</th>
          <th>Received Data</th>
        </tr>
        <tr class="message info empty">
          <td colspan="9">No events have been received yet.</td>
        </tr>
        <tr class="actions">
          <td colspan="3" class="message error"></td>
          <td><button type="button" name="clear">Clear Events</button></td>
        </tr>
      </table>

      <template id="event">
        <tr class="event">
          <td class="trust"
            data-title-trusted="This 'MessageEvent' has been marked as TRUSTED, because at the time that it was received its 'origin' property exactly matched one of the trusted origins configured above"
            data-title-untrusted="This 'MessageEvent' has been marked as UNTRUSTED, because at the time that it was received its 'origin' property did NOT match any of the trusted origins configured above">
          </td>
          <td class="origin"
            title="The 'origin' property of the received 'MessageEvent'">
            <code></code>
          </td>
          <td class="timestamp"
            title="The 'timestamp' property of the received 'MessageEvent'">
            <code></code>
          </td>
          <td class="data"
            title="The 'data' property of the received 'MessageEvent', JSON encoded">
            <code></code>
          </td>
        </tr>
      </template>
    </article>
  </main>

  <aside class="meta status">
    <h3>Page Status:</h3>
    <ul>
      <li class="info origin">
        This document's origin:
        <br>
        <code class="message info"></code>
      </li>
      <li class="info effective-domain">
        This document's effective domain:
        <br>
        <code class="message info"></code>
      </li>
    </ul>
  </aside>

</body>
