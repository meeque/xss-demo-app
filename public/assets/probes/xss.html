<!DOCTYPE html>
<html>
<head>
    <title>XSS Demo: XSS Probe</title>
    <link rel="stylesheet" href="../common.css">
    <link rel="stylesheet" href="xss.css">
    <script src="../common.js"></script>
    <script src="xss.js"></script>
</head>
<body>
    <header>
        <h1>XSS Demo: XSS Probe</h1>

        <p>
            This simple HTML page tries to invoke the XSS Demo App's global <strong><code>xss()</code></strong> function.
            It can therefore be used to trigger an XSS alert in the XSS Demo App, when the XSS demo page loads this XSS probe page.
        </p>
    </header>

    <aside class="meta status">
        <h3>Page Status:</h3>
        <ul>
            <li class="info origin">
                This document's origin:
                <br>
                <code class="message info"></code>
            </li>
            <li class="info effective-domain">
                This document's effective domain:
                <br>
                <code class="message info"></code>
            </li>
        </ul>
    </aside>

    <main>
        <h2>XSS Probes</h2>
        <p>This probe attempts to invoke <strong><code>xss()</code></strong> in two different ways:</p>
        <ul>
            <li class="target parent">
                <h3>Page Parent</h3>
                <p>Run <strong><code>window.parent.xss()</code></strong>.<br>This works when the XSS Demo App opens this page in a <code>frame</code> or <code>iframe</code>.</p>
                <p>Diagnostic status:</p>
                <ul class="status">
                    <li class="success has-target">           This probe page <strong>does</strong> have a parent. </li>
                    <li class="warning has-no-target">        This probe page <strong>does not</strong> have a parent. </li>
                    <li class="info target-origin">           The parent's origin is:<br> <code class="message info"></code></li>
                    <li class="info target-effective-domain"> The parent's effective domain is:<br> <code class="message info"></code></li>
                    <li class="success xss-available">        The parent <strong>does</strong> have an <code>xss</code> entry in its global namespace. </li>
                    <li class="warning xss-unavailable">      The parent <strong>does not</strong> have an <code>xss</code> entry in its global namespace. </li>
                    <li class="success xss-invoked">          This probe <strong>has</strong> invoked <code>xss()</code> in the parent. </li>
                    <li class="warning xss-not-invoked">      This probe <strong>has not</strong> invoked <code>xss()</code> in the parent, because it is not a function. </li>
                    <li class="message success xss-success">  This probe has <strong>successfully</strong> exectuted <code>xss()</code> in the parent. </li>
                    <li class="message error xss-error">      This probe has <strong>failed</strong> to exectute <code>xss()</code> in the parent with the following error:<br> <code class="error"></code> </li>
                </ul>
            </li>
            <li class="target opener">
                <h3>Page Opener</h3>
                <p>Run <strong><code>window.opener.xss()</code></strong>.<br> This works when the XSS Demo App opens this page in a new window or tab, e.g. through a link with <code>target="_blank"</code>.</p>
                <p>Diagnostic status:</p>
                <ul class="status">
                    <li class="success has-target">           This probe page <strong>does</strong> have an opener. </li>
                    <li class="warning has-no-target">        This probe page <strong>does not</strong> have an opener. </li>
                    <li class="info target-origin">           The opener's origin is:<br><code class="message info"></code></li>
                    <li class="info target-effective-domain"> The opener's effective domain is:<br> <code class="message info"></code></li>
                    <li class="success xss-available">        The opener <strong>does</strong> have an <code>xss</code> entry in its global namespace. </li>
                    <li class="warning xss-unavailable">      The opener <strong>does not</strong> have an <code>xss</code> entry in its global namespace. </li>
                    <li class="success xss-invoked">          This probe <strong>has</strong> invoked <code>xss()</code> in the opener. </li>
                    <li class="warning xss-not-invoked">      This probe <strong>has not</strong> invoked <code>xss()</code> in the opener, because it is not a function. </li>
                    <li class="message success xss-success">  This probe has <strong>successfully</strong> exectuted <code>xss()</code> in the opener. </li>
                    <li class="message error xss-error">      This probe has <strong>failed</strong> to exectute <code>xss()</code> in the opener with the following error:<br> <code class="error"></code> </li>
                </ul>
            </li>
        </ul>
    </main>

    <aside>
        <h3>Note:</h3>
        <p>
            <em>
                Successful triggering of <code>xss()</code> and other diagnostic status printed above is subject to <strong>same-origin policy</strong>.<br>
                If the <a href="/" target="_top">XSS Demo App</a> (or any other parent or opener) has a different origin, this probe will fail! See error messages above.
            </em>
        </p>
    </aside>
</body>
</html>
